<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Fourier Transform: A R Tutorial</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>


<!-- MathJax scripts -->
<script type="text/javascript" src="https://c328740.ssl.cf1.rackcdn.com/mathjax/2.0-latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



</head>

<body>
<h1>Fourier Transform: A R Tutorial</h1>

<p>Main references:</p>

<ul>
<li>Better Explained&#39;s <a href="http://betterexplained.com/articles/an-interactive-guide-to-the-fourier-transform/">Fourier Transform tutorial</a></li>
<li><a href="http://www.alwayslearn.com/Fourier/Fourier_Superposition.html">A DFT &amp; FFT Tutorial</a></li>
</ul>

<h2>Complex Wave</h2>

<p>It is known that <em>two or more sine waves can transverse the same path at the same time without mutual interference</em>. Given the complex wave it is possible to extract its components (<em>how</em> that can be done is another problem).</p>

<p>Here are two examples of sine waves:</p>

<pre><code class="r">xs &lt;- seq(-2*pi,2*pi,pi/100)
wave.1 &lt;- sin(3*xs)
wave.2 &lt;- sin(10*xs)
par(mfrow = c(1, 2))
plot(xs,wave.1,type=&quot;l&quot;,ylim=c(-1,1)); abline(h=0,lty=3)
plot(xs,wave.2,type=&quot;l&quot;,ylim=c(-1,1)); abline(h=0,lty=3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABIAAAAFoCAMAAAAYWXAgAAAAdVBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCP29qP2/21ZgC1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v1uXvEVAAAAJ3RSTlP//////////////////////////////////////////////////wCDVpfZAAAACXBIWXMAAAsSAAALEgHS3X78AAAXv0lEQVR4nO2djVobSZJFp+wxzIzHNLsLPdP2wC5I6P0fcS1st2WUWcqfmxmRWed83R84ibqKKmUcCoHNXw4AAEb8xboBANguCAgAzEBAAGAGAgIAMxAQAJiBgADADAQEAGYgIAAwAwEBgBkICADMQEAAYAYCAgAzEBAAmIGAAMAMBAQAZiAgADADAQGAGQgIAMxAQABgBgICADMQEACYgYAAwAwEBABmICAAMAMBAYAZCAgAzEBAAGAGAgIAMxAQAJiBgADADAQEAGYgIAAwAwEBgBkICADMQEAAYAYCAgAzEBAAmIGAAMAMBAQAZiAgADADAQGAGQgIAMxAQABgBgICADMQEACYgYAAwAwEBABmICAAMAMBAYAZCAgAzEBAAGAGAgIAMxAQAJiBgADADAQEAGYgIAAwAwEBgBkICADMqBHQAltAttfYP5tkfRNcFtDu+jXm/cP5BirdeTAQtc8y+2fb1Aro5f7u9e3zh6fMaJiCymeZ/bNxagW0v3345W16NExB5bPM/tk43AFBFdwBQQ3VrwHtb/gafsvUPsvsn21TLaDiaJiCht8Fa5YMfkBAUAUCghpUAjp5ETHxO/zfS1MfICFLl6TMUiUpL5YyShOTvn+ylkcs9t2dojijpO0d0JJUlfxooiifXSnbEnbV/w7I92whoITijJKmAlqSqtIfTBglyvLZlVqxjXA+tTkZTooRUKhAN+qaKJ9dKdtSuqy7gJbwenh5xGLf3SmK39SsMoqAlsSH7Bsl16I/xW5XQBkZToqnFND3H+MI/SDHpQdf3rytwaeA9FGKLKXLqmOy94+b2XLhFAR0eLn/VBbdQkCCrOXsneosXycove71Kbn7x81suXAKAvr6Oey3z0XRLWbK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" alt="plot of chunk waves.1.2"/> </p>

<p>which can be linearly combined into a complex wave:</p>

<pre><code class="r">wave.3 &lt;- 0.5 * wave.1 + 0.25 * wave.2
plot(xs,wave.3,type=&quot;l&quot;); title(&quot;Eg complex wave&quot;); abline(h=0,lty=3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAAilBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZmU5ZrU5j9plAABlADllAGVlOQBlOY9lZjllZmVltbVltf2POQCPOTmPOWWPZgCPj2WPtY+P29qP2/21ZgC1tWW1/rW1/v3ajzna/rXa/tra/v39tWX924/9/rX9/tr9/v0EVHXiAAAALnRSTlP///////////////////////////////////////////////////////////8Ago9zVQAAAAlwSFlzAAALEgAACxIB0t1+/AAAEklJREFUeJztnY1647YRRYN1HDupGyvbNrWTtrESK7Ek6/1fryT1Y1kECRDEQMDg3C9ZixR5h7pzFgIhr/3NDiFF+ubaF4BQTAE0UiWARqoE0EiVABqpEkAjVQJopEoAjVQJoJEqATRSJYBGqgTQSJUAGqkSQCNVAmikSgCNVAmgkSoBNFIlgEaqBNBIlQAaqRJAI1UCaKRKAI1UCaCRKgF0qLYL0+rLS9C5N6/RLwi1AuhQAXSWAuhQbRe3b/tH78/m5o/jVrNhOlpXDe2Pu93afNc8/dpsPTXP3fzePbsHuj3iabfb3N+8Nmc9dSc3+1fNaa35ev/XZWnumme6Pw8noBEBdKi25wibb+/3W91Gy+yyG7/vdmtzVIdtq9u3Duj9EY8trE/rjtoW2aeO3bV53L8DtFw3zttFh/bhBDQsgA7VYcpx+9aOsA2Je6C7jYbQzX1DYIvhugF5c2+e2scN0O3g2260O5szuiF5u/j2/jAF2dw3IP/cDOj7mUx73Ptz83jd1TmegIYF0KE6Ad2Nrsfxen0YQfdD7mo/9h653NO4akffm9fD0N2Suz7NJLaLu833//v+Zdke2FY4TEGavyK7sxPQoAA6VKcpxwXQdx87P4C+fRsDevUxkVje/N7Mx/+9uGsG68PkpTn7z3aKAtA+AuhQnYDuTzkaZM+mHOdAX045DgbfPR8xXX/51+3b8u/3T93A3Lntll/+2wL/cQIaFkCH6jDlME+um8JPQPduCvfPnGBtXB8blk8Dcgt0M1Z3vB9PuOarzl4AHaoT0O2jj2W7FrsOv9Oy3acpx+9mv2jRjbx7PFft7GR5mHR063fdwkb79OOq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" alt="plot of chunk unnamed-chunk-2"/> </p>

<h2>Fourier Series</h2>

<p>Joseph Fourier showed that <em>any</em> periodic wave can be represented by a sum of simple sine waves. This sum is called the <strong>Fourier Series</strong>. The Fourier Series only holds while the system is linear. If there is, eg, some overflow effect (a threshold where the output remains the same no matter how much input is given), a non-linear effect enters the picture, breaking the sinusoidal wave and the superposition principle.</p>

<pre><code class="r">wave.4 &lt;- wave.3
wave.4[wave.3&gt;0.5] &lt;- 0.5
plot(xs,wave.4,type=&quot;l&quot;,ylim=c(-1.25,1.25)); title(&quot;overflowed, non-linear complex wave&quot;); abline(h=0,lty=3)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAAllBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OWU5OY85ZmU5ZrU5j485j9plAABlADllAGVlOQBlOY9lZjllZmVltbVltf2POQCPOTmPOWWPZgCPj2WPtY+P27WP29qP2/21ZgC1tWW1/rW1/v3ajzna24/a/rXa/tra/v39tWX924/9/rX9/tr9/v15ARmaAAAAMnRSTlP/////////////////////////////////////////////////////////////////AA1QmO8AAAAJcEhZcwAACxIAAAsSAdLdfvwAABBuSURBVHic7Z0Ne6vGEUa7TuvYSd1UujdNYif9iJ1cNbUk6///uQJCCAkkYHdnBS/nPDexhWAGzRyvFmTDn3YAQvzp1jsAEBOEBikQGqRAaJACoUEKhAYpEBqkQGiQAqFBCoQGKRAapEBokAKhQQqEBikQGqRAaJACoUEKhAYpEBqkQGiQAqFBCoQGKRAapEBokAKhQQqEbmHz6O7+s/zqS/ea2+X9e9+o2yzitlfUIRHjRdMAoVt4c889ZRkqdMhepYg4fWYp9Mo5t8i9fdiV/8+XPO92Hy93P7iC+z8KWfZrfrxk36+ybwp/y3Wzpc79VBM6W+s35wrFygS1JbvjCH22Xh5qnX29e92nz76Wweuh1u7rl2zBKl+/CrCt9vE5f1vJQ5d7VtvfMnbzxWoyR6HfCmUfMkkyG7fLotuuNDf78pfvK6EPa64yAd6KLRan6zpXF7pcu9rsuCTnKPTperl3+0jFM0XA/Tq1PVi7A1WA+/ftcR8XxfvKusxV299D7OaL1WSGQm8es67mrc0GxNfC6s1j1ux8WMtU2Y9j+ylHtebmMRPjx2yAzL8t181HxMycE6EXZbgqQbmkeL4m9OI07eHZMv1uP9zmu1GFWrs8o3uuwmaiPu/38RBku/zzY/luUNvfY+zzF5u06MmYodD7YSwfxFbFgPt8GP5KxY9CV2tulw+bb/79zetbvqxct3hyezLlKOTLB8Nys2pJpuJ+zK/UOkwG9vOBYowunyn3cXG6r/k3h433Nq7y0be2P8XEpZxJ1Pb3ELv5YhOWPCGzFjqzqphZdAq9e/vqt69+X/60fNhdE7oY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" alt="plot of chunk unnamed-chunk-3"/> </p>

<p>Also, the Fourier Series only holds if the waves are periodic, ie, they have a repeating pattern (non periodic waves are dealt by the Fourier Transform, see below). A periodic wave has a frequency \( f \) and a wavelength \( \lambda \) (a wavelength is the distance in the medium between the beginning and end of a cycle, \( \lambda = v/f_0 \), where \( v \) is the wave velocity) that are defined by the repeating pattern. A non-periodic wave does not have a frequency or wavelength.</p>

<p>Some concepts:</p>

<ul>
<li>The <strong>fundamental period</strong>, T, is the period of all the samples taken, the time between the first sample and the last</li>
<li>The <strong>sampling rate</strong>, sr, is the number of samples taken over a time period (aka <em>acquisition frequency</em>). For simplicity we will make the time interval between samples equal. This time interval is called the <strong>sample interval</strong>, si, which is the fundamental period time divided by the number of samples \( N \). So, \( si = \frac{T}{N} \)</li>
<li>The <strong>fundamental frequency</strong>, \( f_0 \), which is \( \frac{1}{T} \). The fundamental frequency is the frequency of the repeating pattern or how long the wavelength is. In the previous waves, the fundamental frequency was \( \frac{1}{2\pi} \). The frequencies of the wave components must be integer multiples of the fundamental frequency.  \( f_0 \) is called the first <strong>harmonic</strong>, the second harmonic is \( 2*f_0 \), the third is \( 3*f_0 \), etc.</li>
</ul>

<pre><code class="r">repeat.xs     &lt;- seq(-2*pi,0,pi/100)
wave.3.repeat &lt;- 0.5*sin(3*repeat.xs) + 0.25*sin(10*repeat.xs)
plot(xs,wave.3,type=&quot;l&quot;); title(&quot;Repeating pattern&quot;)
points(repeat.xs,wave.3.repeat,type=&quot;l&quot;,col=&quot;red&quot;); abline(h=0,v=c(-2*pi,0),lty=3)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-4"/> </p>

<p><code>wave.3</code> is the weighted sum of <code>wave.1</code> and <code>wave.2</code>. This equation is the Fourier Series for <code>wave.3</code>:</p>

<p>\[ f(t) = 0.5 \times sin(3wt) + 0.25 \times sin(10wt) \]</p>

<p>where \( w \) is the angular frequency (aka angular speed) in radians/second, \( w=2\pi f_0 \), where \( f_0 \) is the fundamental frequency of the complex wave. In this case, the first component (<code>wave.1</code>) has thrice the frequency and the second component has 10 times that of \( f_0 \).</p>

<p>Here&#39;s a R function for plotting trajectories given a fourier series:</p>

<pre><code class="r">plot.fourier &lt;- function(fourier.series, f.0, ts) {
  w &lt;- 2*pi*f.0
  trajectory &lt;- sapply(ts, function(t) fourier.series(t,w))
  plot(ts, trajectory, type=&quot;l&quot;, xlab=&quot;time&quot;, ylab=&quot;f(t)&quot;); abline(h=0,lty=3)
}

# An eg
plot.fourier(function(t,w) {sin(w*t)}, 1, ts=seq(0,1,1/100)) 
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk plot.fourier.series"/> </p>

<p>And the plotting of equation \( f(t) = 0.5 \times sin(3wt) + 0.25 \times sin(10wt) \):</p>

<pre><code class="r">acq.freq &lt;- 100                    # data acquisition frequency (Hz)
time     &lt;- 6                      # measuring time interval (seconds)
ts       &lt;- seq(0,time,1/acq.freq) # vector of sampling time-points (s) 
f.0      &lt;- 1/time                 # fundamental frequency (Hz)

dc.component       &lt;- 0
component.freqs    &lt;- c(3,10)      # frequency of signal components (Hz)
component.delay    &lt;- c(0,0)       # delay of signal components (radians)
component.strength &lt;- c(.5,.25)    # strength of signal components

f &lt;- function(t,w) { 
  dc.component + 
  sum( component.strength * sin(component.freqs*w*t + component.delay)) 
}

plot.fourier(f,f.0,ts)   
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-5"/> </p>

<h2>Phase Shifts</h2>

<p>Another feature of the fourier series is phase shift. Phase shifts are translations in the x-axis for a given wave component. These shifts are measured in angles (radians). </p>

<p>Taking the previous example and shifting <code>wave.1</code> by \( \frac{\pi}{2} \) we would produce the following fourier series:</p>

<p>\[ f(t) = 0.5 \times sin(3wt + \frac{\pi}{2}) + 0.25 \times sin(10wt) \]</p>

<p>which produces the following trajectory:</p>

<pre><code class="r">component.delay &lt;- c(pi/2,0)       # delay of signal components (radians)
plot.fourier(f,f.0,ts)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAAeFBMVEX9/v0AAAAAADkAAGUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j9plAABlADllAGVlOQBlOY9lZrVltf2POQCPOTmPOWWPZgCPj2WPtY+P29qP2/21ZgC1ZmW124+1/rW1/v3ajzna/v39tWX924/9/rX9/tr9/v2qrYZwAAAAKHRSTlP///////////////////////////////////////////////////8AvqouGAAAAAlwSFlzAAALEgAACxIB0t1+/AAAD9ZJREFUeJztnQtbW7kRQFd50DQbNt2GpG027RIwvv//HxabhRDuS48ZaTQ65/sSbF95ZmQfy5KuMb9MAI74pXUBAJIgNLgCocEVCA2uQGhwBUKDKxAaXIHQ4AqEBlcgNLgCocEVCA2uQGhwBUKDKxAaXIHQ4AqEBlcgNLgCocEVCA2uQGhwBUKDKxAaXIHQ4AqEBlcgNLgCocEVCA2uQGhwBUKDKxAaXIHQ4AqEBlcgNLgCocEVCA2uQGhwBUKDKxAaXIHQ4AqEBlcgNLgCocEVCA2uQGhwBUKDKxAaXIHQ4AqEBlcgNLgCocEVCA2uQGhwBUKDKxAaXIHQ4AqEBlcgNLiiROgAUB9FoQvuC5AHQoMrEBpcgdDgCoQGVyA0uAKhwRUIncbuRie0BaGTCJPPfvkBoVMIz/4HkyB0AuGnH2ARhI4nzC6AORA6HoTugKZC7384yhJh8SLYoqXQnW0ZIHQPNBS6ty2DsHIZLIHQsYTVK2CIdkKHFz+tg9BdgNCxIHQXNBM6LFyyTNi4BnZA6EjC5lWwQiuhu9syQOg+QOg4XtbYQ81DgtBxIHQnNBK6uyXWrMQOan6gq48XlIPQcXQrdGefLygGoaOYV2i/5jOdnY4tp43Q3c1IFwo0X/OJ8X4lAaGj6FToAT/BjdBRIHQvNBG6uxXWUn3Wa57G/AS3DaGtP96L5RmveULoBRD6TP9Cd1CtDC2E7m9C2qfQQ37gFaEjWK7Ods1Tf5v9IpQKfffxerq7DOHNTXzo7pZYK8WZrnlC6CVihD45PR1+jQ7d3/t3n0J3tzcqgoDQh/c3DyN1ZGiErgNCL7Av9OWrr19OI/T72ZzDjdBJHbFDd7v9IpQvCo9X4e10+3o2QCd6YPjRTloMmKG7vVEZ6u9y9Pf+PZjQfX+AGqH38SJ0XL0htqFNpIR+tijc+SO1CF2F7L3REN2yLXkeVfw6XbOPYcopfDvkCh3im7YFoXPZKMxszdlChxc/zZK59bQv9OHiPL1I2OXIq6QdQwptuWtntIQ+Xn06/7ydn/tG6IZkbvaHhUs20RL6cTGYcKYwr5J2+BF6t96wctkeuQv1iiO01UdwsyyjNSP0Gvtz6NNH7UTm0FYfwYGEDhvXjKEndEZOofaV8CT0Tr0InZdTqH0luhQ6b8nUj9DZ5wYQOskBM2QJ/fKg0b6d6EJomw9g0rTTDFnvyAidm1TqDjUYR+jZIaN9O4HQ2XQpdNbzPT9ks3NTyakBhHYmdJLrNjs3IXQJKecizJDzhC8cMNm3E50IbfEB3C3JYM0IvQ5CFzdoQcpextbNJjuX1b1HELq4QQNyzgWZEXr9d51+NMk8NiF0REm9FZ3yKY8GfTun3FEaofPxJ3TKWFy/byEiccmHEeoKbU+OiILM1SwodPXOhdmFrUbJBxF6FKHX7tFM6OyNDITexKPQKRt0lTsXVi6vt0o7iNAxBXVXdMIpQYtC5y8YJ4QeXei6nQsb1/Zvjzk6utBR9VgrOn3vPP/Emyz+hLYmB0I3FDpvKxGht4grx1jRyXvnBecpRIl7nSF0AV0KnbwzU7JrIMksVcqOeeRhhBZrVY3UhWzRnFSSKKHTV7w/MbbQkdXYKrpboeO2xzsT2pYcscWYKjp1JVv2Fi4IQqvjWOinVoWCCBI1wUjewXkBQku2q0Ji0aWGiBG3p4HQJbgW+tww4u8DmRK6uNyhhY6vpdOqo/7cVVuhU3YYY1ogtHBLfaRrsSR08hb7jOpCW3IDoTXipaaJ32GMaYLQAk3rdsmx0AIzJIQubno/Ua35p1nlU9Upfj1L9JZ5TJuRhU6pZO/paLubay1iYpbYLfOYRghd2DbpyZCgU6G3ksTumMe0qi+0HaOTCtlboyN0QZLzwch5G0KvIiB04oJGAo9Cx3ybUlygkYVOq2OxdeKOkwgKeWqULpYDoddIrGOheepJLgk0slSoXC4FQq+B0Jox1VIg9BrFQr+8xcBc1E5MtRT2hDZidHIVszsgdIsUCL2CvNB9La6UY6qlQOgV0qsIm1ezQpbWYDqqTgKEXgGhtaPqJEDoFUqFXrq/fs8Q2qDQJozOqWH3PApC6ydA6GUQWj2qTgKEXiarhrBwqThoZgX2o+rER+hl8moIL37KRE3P30tchfAILVpC2L43QquHtyi0AaPzX4ybn3REaPXwCF2zAoRWDz+w0BtZ1AroyIwacRWiDyv05i9jI3StwOLBi4U+XJynja+vU0NvUO0ccfXdiI6GukqRpYPHCX17lvbTQoPj1cOtt29uEkMXVFXOzv4aQleLLB08Rujb8Pb043i1oPTdx+uffsaHLqiqmJ0zIIrp+zGjUmTp4BFC3/3+NPj+d2ZtlyP03jlqhK4XWTp41JTjYfhdGIRPt17Kz6Grrp0WciF0vcjSsWNG6AdlQ5gPwiWhle6aHH2eq59nr17wbkInjNDCodXumxp8lgvpqsauP0L/8+nqfA79yDPnwxPn3V7+/fQvGKjB87+wL/TmLscGO6HV7pscO+wc183eReh+yo4RemsfOj+02n3TY4ed47rZewjdz3ozQujtGbTGmcLqz03YPqyd3nzkjqqOEvrPdaV19qFrP4AuhO70naW+0NO3v9Z4C6Ow0pnC6iNC2Dmund90YN3oDYTemnT4GKGf3artczdm1IreQugtVM4UNnj8ws5x9QLsBtaNbk3o7NCq986IG1TTxlRgNK5udOm4CP3jSMIfPtCpwGZc3egIXUYNY9uU0OliFqGniBOceWEr0YkZleIPI/TW3GB6OHEvG7UanZhRKT5CF63eDPisVQRCx8QzKHTR/hpCG4svHtWu0HtnQLLi+xW60/3z4YUuPEeN0MYyjC502GuQHrI+fZhRJ8NIQi8ECDvH0yM2QaMMhI4KaFro9AwIbSyDfMyuhH55A0LrxtTPMJbQ+wKnpkBoYxnGFnp3CpIasBV9qFEjxdBC7+56pAZsRxdq1EgxmND7u3QIrRiyQoqRhd47z5IaryXVn0erOQYWeiVaUhIrPmdsz+zdA6HjIjYWev+TG0MIff6SK9GIefTwxmJc6Kcga8FGEDpE3Aeh4yI2F3r32UzJYkborNfh1n3q9AyhJQjbofwLHWYXyuLlg9AibP8GYUIWOz5nvgxl3qfyEc9Sf5lpQWixLH0Kvb/TkxavBOk0CF2UpnuhZZbGBSB0BboUOr6W/dP/KdEKQegKZKrRGLdCJ33/FEKXpOlS6Jftlu9nR+iYPfOUeMn0L3TLRy8fUaHr9Sz2DHxcRRp1I3QbsoteuqMZoWO2zOOjZYHQbYgsZt7MstBRO4zR0fJwIHTD4aCA7KLjHFciWuioohC6JBFCC7CZKqxeyYmWCUI3Iv89OWparcVWrqgdxqQWGSB0I+SErtqxjWRh82parHw8CN1uBVJAQc3J5ggSL/R+XQhdksmYz3Fn3aJuNiJ0+kwIoUsyORI6ffUlB0LXYDShk/fHBIl6kW22jG+QA0K3omTRlHoGQxA5oXUqdyF00WjXiqJdgBDTSIW4ef1W08jDmYwitDmfC2sOEW1UQOga9Ch04VtyiIohD0LXYEChz4er/CnnhbxxN0a9JKXxIXSjFXUZpYumOn+ZfJ42+sbtHigVj9DNaPKOXE7K5CJmFSDMIEJbtAOhNUDodrSYYgqwUBhCi9PjcOdG6ITz4VGHSkDodrRYMwkgI7RW/xC6HZ0KPSstaxhG6JJkNu0YQOj1YwhdksyoHQ3WTBKEzauRB60Kfffxerq7DOHNTWpoYXoc7uovmWQIG9c2m0beqQQBoU9OT4dfU0MLg9D1CKtXtptG36sAAaEP728eRuq00MIgdD0ShF47bFfoy1dfv5xG6PezOYcdoa3a0avQz6vLPKVlVuhpOl6Ft9Pt69kAjdD7VF8yCeFa6NzQwiB0RcLCpf22ezeKgNAtQWhxpIQ2vSg0q0f1PQAhwuxCRNvdG0UYYYS2q0evQj8WGFXnUqOuhA6PZBWUTf2PDQhQe8kkRnj2f1TTvZukKBb6cHGWt/kuB0LXJX7I6kvo49Wn88/b+blvhN5nuTTDBecw745hoR8Xg80XhQhtlll3NPvnZ4TucoU1hNCz/lgW+vxROxNz6C6Frr2p1YauhM4OLY4boU0XnANCi+Yz7ccQQr/okWr/ZIT+/iE9tDw9TkgRWjXVDIRWpu4mbSsQOguENktYuaybaYGe5tAIbReEFstoXI9BhE76wKlQokUQWpuqp9HagdBSGa37MYjQT93S7h5CN2YUoR/7hdBlKe3rETavOiI8/aeeZR2EVmcYoacqv/SB0K0ZR+gq+BK6yxlpWL0C6TgXugc/EFoShG5OvbNoI+BM6C5npGHxImThW+g+/Kh2Fm0EELo9CC2IN6G7XGLVOi08Aq6F7kaQSqeFRwChLRCe/Q9FuBO6zz2D0znhfqq1jGehuzKk9ndbegWhwRX+hGbPYGgcCs0Sa2QQGlzhUWj2DAbGpdDsGYyLU6FhVBAaXIHQ4AqEBlcgNLgCocEVCA2u0BQaoD56Qq95Lh+ycgIHXRj2MULoJhn6T2C1CwjdJEP/Cax2AaGbZOg/gdUuIHSTDP0nsNoFhG6Sof8EVruA0E0y9J/AahcUhAZoB0KDKxAaXIHQ4AqEBlcgNLgCocEVCA2uQGhwBUKDK6SFvrsMb26EY77g8O5aN/5FCJ80E9yG8Fq3C9PxSrUH0/eg3IfjVXj1R84dhYU+PZDf38rGfMGtsg13v/0xHf6W9WDGcXpBKj9G98LpCv1NN/w5wW3WyCgs9N3Ha+UR9Nur/+iO0Lcn17SfMOV3mcPf/6HageNnxRf8iZNHeQgLfXh/cx7iNNGeckyTeheUR+jj56+6U477iaXutOzw/l82phynt4n+hT5efVCNf7jIe7Ji+f5BeQ59mpKpjtKHi0/nwTEdRug5d5e6Pk/KbwH3T4L2ovCE5rQs36Pu5tA1djn0ZVC14fv56yvUX5SaXbj73YjQpzdr7RW89oJK2+ca0zLlEfrUheMX1bW/kSmHg33oh/FN04f7DLpz6Cr70LpduPcob3eWM4XgCoQGVyA0uAKhwRUIDa5AaHAFQoMrEBpcgdDgCoQGVyA0uAKhwRUIDa5AaHAFQoMrEBpcgdDgCoQGVyA0uAKhwRUIXY3Du+sKX/o0OghdDWyuAULX4vSL+f97d338/O8QPtyevwgm+3f1YRWErsbDlON49XY6XLw9j9ff9L+VZzgQuhp/Cf354XsO73774/T1SfnfGwuLIHQ15kKfvpRW+zuURgOhqzEXmtFZHoSuxkzo0xw67+8uwCoIXY3j1cMuxw+h7+cczDiEQWhwBUKDKxAaXIHQ4AqEBlcgNLgCocEVCA2uQGhwBUKDKxAaXIHQ4AqEBlcgNLgCocEVCA2uQGhwBUKDK/4Pr1vu5AhF7XMAAAAASUVORK5CYII=" alt="plot of chunk unnamed-chunk-6"/> </p>

<h2>DC Components</h2>

<p>This concept deals with translations over the y-axis. In this case corresponds to an additive constant signal.</p>

<p>Applying a DC component of \( -2 \) to the previous ware would result in the following equation and plot:</p>

<p>\[ f(t) = -2 + 0.5 \times sin(3wt + \frac{\pi}{2}) + 0.25 \times sin(10wt) \]</p>

<pre><code class="r">dc.component &lt;- -2
plot.fourier(f,f.0,ts)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-7"/> </p>

<h2>The General Equation</h2>

<p>Adding these concepts we get the general form of the Fourier Series:</p>

<p>\[ f(t) = a_0 + \sum_k  a_k \times sin(kwt + \rho_k) \]</p>

<p>where \( a_0 \) is the DC component, \( w=2\pi f_0 \), where \( f_0 \) is the fundamental frequency of the original wave. </p>

<p>Each wave component \( a_k \times sin(kwt + \rho_k) \) is also called a <strong>harmonic</strong>.</p>

<p>There is also an alternative representation using the identity:</p>

<p>\[ sin(a+b) = sin(a)cos(b) + cos(a)sin(b) \]</p>

<p>which allow us to replace phase shifts with cosines.</p>

<p>The Fourier Transform (FT) is a generalization to solve for non-periodic waves.
The FT assumes that the finite analyzed segment corresponds to one period of an infinitely extended periodic signal.</p>

<h2>Fourier Transform</h2>

<p>The Fourier Transform sees <em>every</em> trajectory (aka time signal, aka signal) <em>as a set of circular motions</em>.</p>

<p>Given a trajectory the fourier transform (FT) breaks it into a set of related cycles that describes it. Each cycle has a <strong>strength</strong>, a <strong>delay</strong> and a <strong>speed</strong>. These cycles are easier to handle, ie, compare, modify, simplify, and if needed, they can be used to reconstruct the original trajectory.</p>

<p>The trajectory is processed thru a set of filters:</p>

<ul>
<li>each filter gives us a cycle and the remainder of the trajectory </li>
<li>filters are independent, each one catches a different part of the trajectory</li>
<li>there are enough filters to catch all of the trajectory, ie, the last filter leaves no trajectory remainder</li>
</ul>

<p>The result cycles can be combined linearly, giving the same results no matter the mixing order.</p>

<p>So, the FT algorithm receives a trajectory, apply its filters to find the appropriate cycles, and outputs the full set of cyclic components. There are two algorithms:</p>

<ul>
<li>the Discrete Fourier Transform (DFT) which requires \( O(N^2) \) operations (for N samples)</li>
<li>the Fast Fourier Transform (FFT) which requires \( O(N log_2(N)) \) operations</li>
</ul>

<p>This tutorial does not focus on the algorithms. There&#39;s a R function called <code>fft()</code> that computes the FFT. </p>

<p>Here are two egs of use, a stationary and an increasing trajectory:</p>

<pre><code class="r">library(stats)
fft(c(1,1,1,1)) / 4  # to normalize
</code></pre>

<pre><code>[1] 1+0i 0+0i 0+0i 0+0i
</code></pre>

<pre><code class="r">fft(1:4) / 4  
</code></pre>

<pre><code>[1]  2.5+0.0i -0.5+0.5i -0.5+0.0i -0.5-0.5i
</code></pre>

<p>Soon we will be able to interpret these results :-)</p>

<p>First we need to recapitulate one particular mathematical point.</p>

<h2>Geometric Interpretation of Complex Numbers</h2>

<p>Here&#39;s a Geogebra applet to explain how we can interpret geometrically expressions like \( z \times e^{di} \). Please try until you understand it:</p>

<p><center>
<applet name="ggbApplet" code="geogebra.GeoGebraApplet" archive="geogebra.jar"
  codebase="http://jars.geogebra.org/webstart/4.2/unsigned/"
    width="741" height="511">
    <param name="ggbBase64" value="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" />
    <param name="java_arguments" value="-Xmx1024m -Djnlp.packEnabled=true" />
    <param name="cache_archive" value="geogebra.jar, geogebra_main.jar, geogebra_gui.jar, geogebra_cas.jar, geogebra_algos.jar, geogebra_export.jar, geogebra_javascript.jar, jlatexmath.jar, jlm_greek.jar, jlm_cyrillic.jar, geogebra_properties.jar" />
    <param name="cache_version" value="4.2.24.0, 4.2.24.0, 4.2.24.0, 4.2.24.0, 4.2.24.0, 4.2.24.0, 4.2.24.0, 4.2.24.0, 4.2.24.0, 4.2.24.0, 4.2.24.0" />
    <param name="showResetIcon" value="false" />
    <param name="enableRightClick" value="false" />
    <param name="errorDialogsActive" value="true" />
    <param name="enableLabelDrags" value="false" />
    <param name="showMenuBar" value="false" />
    <param name="showToolBar" value="false" />
    <param name="showToolBarHelp" value="false" />
    <param name="showAlgebraInput" value="false" />
    <param name="useBrowserForJS" value="true" />
    <param name="allowRescaling" value="true" />
This is a Java Applet created using GeoGebra from <a href="http://www.geogebra.org">www.geogebra.org</a> - it looks like you don&#39;t have Java installed, please go to <a href="http://www.java.com">www.java.com</a>
</applet>
</center></p>

<p>So when moving:</p>

<ul>
<li>the d slider makes the point moving in circles</li>
<li>the z slider makes the circular wider or narrower</li>
</ul>

<p>This makes expressions like \( z \times e^{di} \) very good candidates to express circular motions.</p>

<p>To learn about using complex numbers in R check <a href="http://www.johnmyleswhite.com/notebook/2009/12/18/using-complex-numbers-in-r/">www.johnmyleswhite.com/notebook/2009/12/18/using-complex-numbers-in-r/</a></p>

<p>note: With this interpretation the great Euler&#39;s formula, \( e^{\pi i} = -1 \), can be understood: it means a 180 degrees (\( \pi \) radians) rotation, placing the point in the x-axis, in the opposite side of the unit circle, ie, at point (-1,0) in the complex plane, which is the integer \( -1 \).</p>

<h2>Cycle&#39;s properties</h2>

<p>We mentioned that each cycle has a <strong>strength</strong>, a <strong>delay</strong> and a <strong>speed</strong>. How can we represent them? </p>

<ul>
<li>The <strong>strength</strong> is represented by the circle size, which is controlled by \( z \)</li>
<li>The <strong>delay</strong>, or starting point, is given by an initial value of \( d \)</li>
<li>The <strong>speed</strong> will be represented by the rate of change of \( d \) over time</li>
</ul>

<p>Here&#39;s an animation taken shamelessly from Better Explained describing a circular path:</p>

<p><center></p>

<iframe src="http://betterexplained.com/examples/fourier/?cycles=0,1" frameborder=0 width="550px" height="280px"></iframe>

<p></center></p>

<p>Fiddle in the Cycles/Time textboxes to see what happens.</p>

<p>Anyway, remember this output?</p>

<pre><code class="r">fft(1:4) / 4  # to normalize
</code></pre>

<pre><code>[1]  2.5+0.0i -0.5+0.5i -0.5+0.0i -0.5-0.5i
</code></pre>

<p>Here&#39;s an animation for the same trajectory:</p>

<p><center></p>

<iframe src="http://betterexplained.com/examples/fourier/?cycles=2.5,0.71:135,0.5:180,0.71:-135" frameborder=0 width="550px" height="280px"></iframe>

<p></center></p>

<p>In the Cycles textbox the values after the colons mean the starting point of that cycle (in degrees), ie, the cycle&#39;s delay. So <code>:180</code> means that that cycle starts at the initial rotation of 180 degrees, or \( \pi \) radians.</p>

<p>The cycles shown here for the trajectory <code>1,2,3,4</code> is <code>2.5 0.71:135 0.5:180 0.71:-135</code> which is just another way to represent the output of the <code>fft()</code> R function. The <code>fft()</code> function returns a sequence complex numbers, while the animation returns pairs <code>strength:delay</code> (in degrees). </p>

<p>Here&#39;s a little function to convert the <code>fft()</code> output to the animation output:</p>

<pre><code class="r"># cs is the vector of complex points to convert
convert.fft &lt;- function(cs, sample.rate=1) {
  cs &lt;- cs / length(cs) # normalize

  distance.center &lt;- function(c)signif( Mod(c),        4)
  angle           &lt;- function(c)signif( 180*Arg(c)/pi, 3)

  df &lt;- data.frame(cycle    = 0:(length(cs)-1),
                   freq     = 0:(length(cs)-1) * sample.rate / length(cs),
                   strength = sapply(cs, distance.center),
                   delay    = sapply(cs, angle))
  df
}

convert.fft(fft(1:4))
</code></pre>

<pre><code>  cycle freq strength delay
1     0 0.00   2.5000     0
2     1 0.25   0.7071   135
3     2 0.50   0.5000   180
4     3 0.75   0.7071  -135
</code></pre>

<p>which is the output of the previous animation.</p>

<p>So this takes care of strength and delay. What about speed? That is given by the cycles&#39; sequence. The first cycle is stationary (0 Hz, ie, the DC component), then for every next cycle, the frequency increases (1Hz, 2Hz, 3Hz,&hellip;).</p>

<p>Try these cycle&#39;s sequences in the animation:</p>

<ul>
<li><code>1</code></li>
<li><code>0 1</code>     <em>this is the first animation</em></li>
<li><code>0 0 1</code></li>
<li>and so on, until you understand the pattern&hellip;</li>
</ul>

<p>A cycle sequence with just one <code>1</code> in the i-th position means a pure cycle of <code>(i+1) Hz</code>, ie, it completes <code>i+1</code> cycles per time interval.</p>

<p>It&#39;s also possible to combine! A sequence <code>1 2 3</code> means that the <code>0 Hz</code> cycle has strength 1, the <code>1 Hz</code> cycle has strength 2, and the <code>2 Hz</code> cycle has strenght 3:</p>

<p><center></p>

<iframe src="http://betterexplained.com/examples/fourier/?cycles=1,2,3" frameborder=0 width="550px" height="280px"></iframe>

<p></center></p>

<p>See how the biggest green vector at the left rotates faster? That one is the <code>2 Hz</code> cycle that we gave the largest strength.</p>

<p>The yellow dots (or ticks) mean the equally spaced time intervals before the trajectory repeats itself. In this case there are 3 since we have cycles up to <code>2 Hz</code>. At tick 0 the three cycles have a combine strength of 6 (1+2+3) since they all start at angle zero (no delays). At tick 1 their sum is -1.5 since both the 2nd and 3rd cycle make a negative contribution, which again happens at tick 2. After that, the trajectory restarts.</p>

<p>The blue line is the weighted sum of all the cycles&#39; values. Notice that the blue line also has values between the data points. Consider it as an interpolation, the values that this modeling suggests where the signal should be between two given data points. But the important part is that, at the required points, the function has the correct values.</p>

<p>With cycle set <code>1 2 3:180</code> we see that initially the <code>2 Hz</code> cycle starts in the opposite side and so the combined strength of the first two cycles balance exactly  the strength of the third cycle. That&#39;s why the first trajectory number is zero.</p>

<p>Usually we want to know the inverse: what should the cycles be so that their combine strengths result on a given known trajectory? That is what DFT/FFT computes.</p>

<p>Say that we want values <code>4 0 0 0</code> in the time series (a peak every four units of time). We must have cycles that start initially with a sum of <code>4</code> and then cancel each other for the next 3 time steps. Use the animation to find what those cycles are. The solution is <code>1 1 1 1</code>. That is, initially all four cycles contribute to the output, then at time t=1 the 2 Hz cycle cancels the 0 Hz cycle (the DC component) while both 1 Hz and 3 Hz are zero. For time t=2 see for yourself what cycles cancel each other. For the last three moments, there is a destructive interference between all four cycles (from 0 Hz to 3 Hz).</p>

<h2>The Equations</h2>

<p>A Fourier Transform converts a wave from the time domain into the frequency domain. There is a set of sine waves that, when sumed together, are equal to any given wave. These sine waves each have a frequency and amplitude. A plot of frequency versus strength (amplitude) on an x-y graph of these sine wave components is a frequency spectrum (we&#39;ll see one briefly). Ie, the trajectory can be translated to a set of frequency spikes.</p>

<p>In equation terms:</p>

<p>\[ X_k = \sum_{n=0}^{N-1} x_n e^{-i.2\pi k n/N} \]</p>

<p>meaning:</p>

<ul>
<li>\( X_k \) amount of frequency \( k \) in the signal; each \( k^{th} \) value is a complex number including strength (amplitute) and phase shift</li>
<li>\( N \) number of samples </li>
<li>\( n \) current sample, \( n \in \{0\ldots N-1\} \)</li>
<li>\( k \) current frequency, between 0 Hz to N-1 Hz</li>
<li>\( 1/N \) not necessary but it gives the actual sizes of the time spikes</li>
<li>\( n/N \) is the  percent of the time we&#39;ve gone through</li>
<li>\( 2 \pi k \) the speed in radians/second</li>
<li>\( e^{-ix} \) the backwards-moving circular path. This last three tell how far we&#39;ve moved, for this speed and time.</li>
</ul>

<p>The function <code>fft()</code> returns these \( X_k \).</p>

<p>An inverse Fourier Transform (IFT) converts the frequency domain components back into the original time wave. This is given by the next equation:</p>

<p>\[ x_n = \frac{1}{N} \sum_{k=0}^{N-1} X_k e^{i.2\pi k n /N} \]</p>

<p>A function that returns an interpolated trajectory given \( X_k \). It is interpolated because the only data we know are the measures (eg: some points like (t=0,signal=4), (1,0), (2,0) and (3,0)). Everything else is given by the results from Fourier Series computed by <code>fft()</code>.</p>

<p>To perform a IFT use <code>fft(X.k, inverse=TRUE) / length(X.k)</code>.</p>

<p>Anyway, here&#39;s a function that applies the previous equation, ie, makes the IFT:</p>

<pre><code class="r"># returns the x.n time series for a given time sequence (ts) and
# a vector with the amount of frequencies k in the signal (X.k)
get.trajectory &lt;- function(X.k,ts,acq.freq) {

  N   &lt;- length(ts)
  i   &lt;- complex(real = 0, imaginary = 1)
  x.n &lt;- rep(0,N)           # create vector to keep the trajectory
  ks  &lt;- 0:(length(X.k)-1)

  for(n in 0:(N-1)) {       # compute each time point x_n based on freqs X.k
    x.n[n+1] &lt;- sum(X.k * exp(i*2*pi*ks*n/N)) / N
  }

  x.n * acq.freq 
}
</code></pre>

<p>Here&#39;s two useful functions:</p>

<ul>
<li><code>plot.frequency.spectrum()</code> plot a frequency spectrum of a given \( X_k \)</li>
<li><code>plot.harmonic()</code> plots the i-th harmonic on the current plot</li>
</ul>

<pre><code class="r">plot.frequency.spectrum &lt;- function(X.k, xlimits=c(0,length(X.k))) {
  plot.data  &lt;- cbind(0:(length(X.k)-1), Mod(X.k))

  # TODO: why this scaling is necessary?
  plot.data[2:length(X.k),2] &lt;- 2*plot.data[2:length(X.k),2] 

  plot(plot.data, t=&quot;h&quot;, lwd=2, main=&quot;&quot;, 
       xlab=&quot;Frequency (Hz)&quot;, ylab=&quot;Strength&quot;, 
       xlim=xlimits, ylim=c(0,max(Mod(plot.data[,2]))))
}

# Plot the i-th harmonic
# Xk: the frequencies computed by the FFt
#  i: which harmonic
# ts: the sampling time points
# acq.freq: the acquisition rate
plot.harmonic &lt;- function(Xk, i, ts, acq.freq, color=&quot;red&quot;) {
  Xk.h &lt;- rep(0,length(Xk))
  Xk.h[i+1] &lt;- Xk[i+1] # i-th harmonic
  harmonic.trajectory &lt;- get.trajectory(Xk.h, ts, acq.freq=acq.freq)
  points(ts, harmonic.trajectory, type=&quot;l&quot;, col=color)
}
</code></pre>

<p>Let&#39;s check that last eg. Notice that this plot is equal to the blue line in the animation:</p>

<pre><code class="r">X.k &lt;- fft(c(4,0,0,0))                   # get amount of each frequency k

time     &lt;- 4                            # measuring time interval (seconds)
acq.freq &lt;- 100                          # data acquisition frequency (Hz)
ts  &lt;- seq(0,time-1/acq.freq,1/acq.freq) # vector of sampling time-points (s) 

x.n &lt;- get.trajectory(X.k,ts,acq.freq)   # create time wave

plot(ts,x.n,type=&quot;l&quot;,ylim=c(-2,4),lwd=2)
abline(v=0:time,h=-2:4,lty=3); abline(h=0)

plot.harmonic(X.k,1,ts,acq.freq,&quot;red&quot;)
plot.harmonic(X.k,2,ts,acq.freq,&quot;green&quot;)
plot.harmonic(X.k,3,ts,acq.freq,&quot;blue&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk known.trajectory"/> </p>

<p>The result has lots of harmonics. Some of them are possibly the result of noise, and hopefully will be very weak. usually, we will just need the strong harmonics: those that contribute meaningfully to the signal. </p>

<p>The highest meaningful sin wave frequency &ndash; after the fft-analysis of the original waveform signal &ndash; is at half the data acquisition frequency, because our input signal is composed of real avlues (ie, trajectory has no imaginary parts). The last useful bin is at acq.freq/2. The <strong>Nyquist Frequency</strong> is half the sampling rate. The Nyquist frequency is the maximum frequency that can be detected for a given sampling rate. This is because in order to measure a wave you need at least two sample points to identify it (trough and peak).</p>

<p>One important point is that any signal can be described in two ways:</p>

<ul>
<li>a <em>time domain</em>, the x-axis is a time variable and the y-axis the signal&#39;s amplitude</li>
<li>a <em>frequency domain</em>, the x-axis is a frequency variable and the y-axis the signal&#39;s amplitude</li>
</ul>

<p>Sometimes it&#39;s easier to deal with one description, sometimes with the other.</p>

<p>The DFT and the IFT are the mathematical tools that translate between these two descriptions.</p>

<h2>Examples</h2>

<p>Let&#39;s try with one eg. We&#39;ll make a trajectory given the following complex wave \( f(t) = 2 + 0.75 \times sin(3wt) + 0.25 \times sin(7wt) + 0.5 \times sin(10wt) \)</p>

<pre><code class="r">acq.freq &lt;- 100                    # data acquisition (sample) frequency (Hz)
time     &lt;- 6                      # measuring time interval (seconds)
ts       &lt;- seq(0,time-1/acq.freq,1/acq.freq) # vector of sampling time-points (s) 
f.0 &lt;- 1/time

dc.component &lt;- 1
component.freqs &lt;- c(3,7,10)        # frequency of signal components (Hz)
component.delay &lt;- c(0,0,0)         # delay of signal components (radians)
component.strength &lt;- c(1.5,.5,.75) # strength of signal components

f   &lt;- function(t,w) { 
  dc.component + 
  sum( component.strength * sin(component.freqs*w*t + component.delay)) 
}

plot.fourier(f,f.0,ts=ts)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-12"/> </p>

<p>Let&#39;s assume that we don&#39;t know the functional form of <code>trajectory</code>, we only have its contents, the period and the sampling time points:</p>

<pre><code class="r">w &lt;- 2*pi*f.0
trajectory &lt;- sapply(ts, function(t) f(t,w))
head(trajectory,n=30)
</code></pre>

<pre><code> [1] 1.000 1.162 1.323 1.482 1.638 1.789 1.935 2.075 2.207 2.332 2.448
[12] 2.554 2.651 2.737 2.812 2.876 2.929 2.971 3.001 3.020 3.028 3.026
[23] 3.013 2.991 2.959 2.919 2.871 2.816 2.755 2.689
</code></pre>

<p>So, given that trajectory we can find where the frequency peaks are:</p>

<pre><code class="r">X.k &lt;- fft(trajectory)                   # find all harmonics with fft()
plot.frequency.spectrum(X.k, xlimits=c(0,20))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-14"/> </p>

<p>And if we only had the frequency peaks we could rebuild the signal:</p>

<pre><code class="r">x.n &lt;- get.trajectory(X.k,ts,acq.freq) / acq.freq  # TODO: why the scaling?
plot(ts,x.n, type=&quot;l&quot;); abline(h=0,lty=3)
points(ts,trajectory,col=&quot;red&quot;,type=&quot;l&quot;) # compare with original
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-15"/> </p>

<p>This function is just for presentation purposes:</p>

<pre><code class="r">plot.show &lt;- function(trajectory, time=1, harmonics=-1, plot.freq=FALSE) {

  acq.freq &lt;- length(trajectory)/time      # data acquisition frequency (Hz)
  ts  &lt;- seq(0,time-1/acq.freq,1/acq.freq) # vector of sampling time-points (s) 

  X.k &lt;- fft(trajectory)
  x.n &lt;- get.trajectory(X.k,ts, acq.freq=acq.freq) / acq.freq

  if (plot.freq)
    plot.frequency.spectrum(X.k)

  max.y &lt;- ceiling(1.5*max(Mod(x.n)))

  if (harmonics[1]==-1) {
    min.y &lt;- floor(min(Mod(x.n)))-1
  } else {
    min.y &lt;- ceiling(-1.5*max(Mod(x.n)))
  }

  plot(ts,x.n, type=&quot;l&quot;,ylim=c(min.y,max.y))
  abline(h=min.y:max.y,v=0:time,lty=3)
  points(ts,trajectory,pch=19,col=&quot;red&quot;)  # the data points we know

  if (harmonics[1]&gt;-1) {
    for(i in 0:length(harmonics)) {
      plot.harmonic(X.k, harmonics[i], ts, acq.freq, color=i+1)
    }
  }
}
</code></pre>

<p>A decreasing signal:</p>

<pre><code class="r">trajectory &lt;- 4:1
plot.show(trajectory, time=2)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-17"/> </p>

<p>A staircase signal:</p>

<pre><code class="r">trajectory &lt;- c(rep(1,5),rep(2,6),rep(3,7))
plot.show(trajectory, time=2, harmonics=0:3, plot.freq=TRUE)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAAh1BMVEX9/v0AAAAAADkAAGUAOTkAOY8AZmUAZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCPtY+P27WP2/21ZgC1Zjm1/rW1/v3ajznatWXa24/a/rXa/v39tWX924/9/rX9/tr9/v0mAaelAAAALXRSTlP//////////////////////////////////////////////////////////wCl7wv9AAAACXBIWXMAAAsSAAALEgHS3X78AAAJoklEQVR4nO3d7ULbyAGG0XUoLWyaFpJuIf3Au7gt2HD/11dL2IEsEEa2ZI1ezvmxTowy1ipPlPEQhp/uIchPY58A9EnQRBE0UQRNFEETRdBEETRRBE0UQRNF0EQRNFEETRRBE0XQRBE0UQRNFEETRdBEETRRBE0UQRNF0EQRNFEETRRBE0XQRBE0UQRNFEETRdBEETRRBE0UQRNF0EQRNFEETRRBE0XQRBE0UQRNFEETRdBEETRRBE0UQRNF0EQRNFEETRRBE0XQRBE0UQRNFEETRdBEETRRBE0UQRNF0ETZJ+gZHN6AQe/xa2E3giaKoIkiaKIImiiCJoqgiXLwoN9aKIR9CJoogiaKoIkiaKIImiiCJoqgiSJoogiaKIImiqCJImiiCJoogiaKoIkiaKIImiiCJoqgiSJoogiaKIImiqCJImiiCJoogiaKoIkiaKIImiiCJoqgiSJoogiaKIImiqCJImiiCJooewe9PJ01jq4LhxY0Q9o36LvLi/bx9vimbGhBM6R9g159uf7u8c2hBc2Q3KGJsvccenVuDk09rHIQZYCgZ1uvfHSHIaFQH8t2Z3NTDirRx5vC+brm5SdvCqlAH8t2t2eW7ahEX8t27tBUoYdlu6bohTk0VbBsRxRBE0XQRBE0UQRNFEETRdBEETRRBE0UQRNF0EQRNFEETRRBE0XQRBE0UQRNFEETRdBEETRRBE0UQRNF0EQRNFEETRRBE0XQRBE0UQRNFEETRdBEETRRBE2UsqBvX/vmmt2HFjRDKgp69fmqt6EFzZDKgn7+La52HlrQDKlsyrE4621oQTOkgqA3357eHJoJsMpBlA5z6K4zaUFzeF2mHMfPvlnsDkMLmiFZ5SCKOTRRyu7Q57sscwiawyu7Q8+bdejFye0Ls+jl6WutC5rD67TK8dvzufTd5UX7+ELrgubwioK+u2zv0Mf//fSs2u37xRfeNwqawyt8UzhfzypOVucXzw5wh6Yqe69ybN4wmkNTBct2RBngH/jPtl75aJfTg24K16GfT563lqezD1feFFKJfT/13bwpbBZBBE0VOnxi5UUPIc9PBE0Vunzq+6U59GbZbvGHj4KmAj0s27V378Xz2gXN4Vm2I0pZ0HeXs+P/dd3LQNAcXum/5Vh+unnp39p1H1rQDKl02W4dtK8ppH4d7tALd2iqVzyH7vw1soJmBFY5iOKrvolSNof+avdRpmHfT313HlrQDKm6ObTgud8jg+r2thM098MGfdi97QTN/WHu0P0MLWgKDBt0n0MLmgKDBr06P2m+dLDjIoeg2d2gQc/P2i9MWZz0MbSgKTDom8L1DHr58doqB4czdNDNv7RbPv+ywR2GFjQFhp1yXLS7Nc5NOTiUgd8Uzo5vmneGfQwtaApYtiOKoIkiaKIImiiCJoqgiSJoogiaKIImiqCJImiiCJoogiaKoIkiaKIImiiCJoqgiSJoogiaKIImiqCJMl7Qy9PXdvcXNDsbLehm07vGC99mVtDsbLSgtxvevbDxnaDZmTs0UcabQ7/+HbIEzc6schClpqBnW6989K1fvcNLkqamoH88tKApIGiijLdst/0mhs/fFQqanY13h2439+8wtKApMOKUY/X5qsvQgqaAOTRRBE0UQRNF0ER5R0ErPsFg9zVBMwZBlx/ABAi6/AAmQNDlBzABgi4/gAkQdPkBTICgyw9gAgRdfgATIOjyA5gAQZcfwAQIuvwAJkDQ5QcwAYIuP4AJEHT5AUyAoMsPYAIEXX4AEyDo8gOYAEGXH8AECLr8ACZA0OUHMAGCLj+ACRB0+QFMgKD7G2Bvg7/C9F9g798lQZcPsLfp9zb+NRL04QZ40/R7G/4SCLr044Ku4QUE/fisoANeQNCPzwo64AUE/fisoANeQNCPzwo64AUE/fhs9UGP/6md8V9g9Iss6IoG2Nv4LzD6RRZ0RQPsbfwXGP0iC7qiAfY2/guMfpEFXdEAexv/BUa/yIKuaIC9jf8Co19kQU9pgLcMPkD910jQUxrgLYIW9JQGqP8Mxx9A0BMaoP4zHH8AQU9ogPrPcPwBBD2hAeo/w/EHEPSEBqj/DMcfYLygl6ezxtF14dCjX6rxB6j/DMcfYLSg7y4v2sfb45uyoUe/VOMPUP8Zjj/AaEGvvlx/99iey8bLLzj2pRp/gPrPcPwBpnOHhiHtPYdenXebQ8OQDr7KAUMSNFEETRRBE0XQRBkyaDi84YJ+rfP+h+yZM+xBpaco6CrVf4a1nqKgq1T/GdZ6ioKuUv1nWOspCrpK9Z9hraco6CrVf4a1nqKgq1T/GdZ6igMEDeMRNFEETRRBE0XQRBE0UQRNFEETRdBEETRR+g56dT57viNNVRazFzcZqcfy43Xt17E9xTovZM9BN/ssLU76HbNn84uxz+DHbptK6r6O7SlWeiF7DrrZAa/941utu69XY5/CD80//Gt9/aq+jg+nWOmF7Dno5aeb+9XnKv9PN9qdzaq8t2w1IVd+HZtTrPRC9hx0s6Vjxb8Ra8ufr2q9uWw0tVR+Hds/c3VeyHd3h27VOf3bmMgdulXfhXx3c+hWfb8PTyxrn0O/p6DvLs8qfnfeaP4yv/tHtancP9RS+XXczooqvJDvch36Q7V/lzcmtA5d4YX0mUKiCJoogiaKoIkiaKIImiiCJoqgiSJoogiaKIImiqCJImiiCJoogiaKoIkiaKIImiiCJoqgiSLoPi1PZ2tnO/7qxdnD9gDbTQKazTnoSNB92msrjXW/3we9LryXs3pXBN2nTYrLP//t6Hp13u7RuX7409erdjekhw3hjpp9kf7Zbgu3/tmHq/nF5lbc/GAb9Hx9oz9pt5uhG0H3aRv06brWebtVTLtjzIdvQT88uTw9a/ZpafbMvT3+z/rHzZ34cbOk9r/ttnH1bUxUPUH3qZ1Dnzzciz9fNY02ma5/uAl68+TmZw/5rn65+bXZr6W5TT/Mwds7ezvdMOfoTNB92t6ht7vNrm/N60zvvk05tk9ugm5nGndf//1L89hsrfV4h374mKA7E3Sfngb9MP/93R36y7ePf7tD3y/+3mbb3qG3QW/2qRV0Z4Lu05Ogm+lyc9Odt3PoZq6xOLrePLkJuplDN13/3Mb73Rx6U7I5dGeC7tPToNsljPbhj03Ns9lfv1xvnnyy5rH+2XYLzyerHL+dt+vZVjm6E/Tw3ti5fPmXzeOzz6OYcXQn6OH9OOjFtz1pf9+vzxTuQNBEETRRBE0UQRNF0EQRNFEETRRBE0XQRBE0UQRNFEETRdBEETRRBE0UQRPl//uflSu60Y/BAAAAAElFTkSuQmCC" alt="plot of chunk unnamed-chunk-18"/> <img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-18"/> </p>

<p>A seesaw:</p>

<pre><code class="r">trajectory &lt;- c(1:5,2:6,3:7)
plot.show(trajectory, time=1, harmonics=c(1,2))
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-19"/> </p>

<p>Assume this time-series with a strong noise component:</p>

<pre><code class="r">set.seed(101)
acq.freq &lt;- 200
time     &lt;- 1
w        &lt;- 2*pi/time
ts       &lt;- seq(0,time,1/acq.freq)
trajectory &lt;- 3*rnorm(101) + 3*sin(3*w*ts)
plot(trajectory, type=&quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-20"/> </p>

<p>We can check if there&#39;s some harmonic hidden in it (there is one, 3Hz harmonics):</p>

<pre><code class="r">X.k &lt;- fft(trajectory)
plot.frequency.spectrum(X.k,xlimits=c(0,acq.freq/2))
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAtAAAAFoCAMAAABJ+DwrAAAAilBMVEX9/v0AAAAAADkAAGUAOTkAOY8AZmUAZo8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j485j9plAABlADllAGVlOQBlOY9lZmVltf2POQCPOTmPOWWPZgCPtY+P27WP29qP2/21ZgC1Zjm1/rW1/v3ajznatWXa24/a/rXa/v39tWX924/9/rX9/tr9/v1zRmY/AAAALnRSTlP///////////////////////////////////////////////////////////8Ago9zVQAAAAlwSFlzAAALEgAACxIB0t1+/AAADBtJREFUeJzt3f9j2sYdh/HizBtO6g4nzbC7rbCadebb///vTScExhESd7qPTqc3z+uHJsWyTobHijjs46c9IOSnoQ8AsETQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkELQkHI96M3DxPn0muBogEhXg949z8s/1/dvP35oAqQXGfT22+uHP8+Dvva5gLnYoNvO0B0PCeguNuj99qk80V+4hiZopBcddOddAz0gaEiJDrp52o6gkR5PCiGlh2k7zxnB9839tgM8DH+GJmgYGn7ajqBhaPhZDoKGIYKGFINpu/nueTKpX0ITNAZg8aRwWTwv3DzypBAZMJi2270sYn7ajqBhKPqSozg9r2f7/XoauuvTZgQNO/FPCpfltF29Z4LGAJjlgBSChhSChhSChhSChhSChhSChhSChhSChhSChhSChhSChhSChhSChhSChhSChpTh17YjaBhi5SRIGf4tKQgahjhDQwpr20EKsxyQQtCQwrQdpPCkEFJ4SwpI4QwNKUzbQQqzHJBC0JBi8aTQXXXwlhTIgkHQ5QTH5pfQXZ82I2jYMQi6fHsVftoOWYgO+unu999eedMgZCL+SeHueTLdr5m2QxaY5YAUgoYUgoYUgoYUgoYUgoYUgoYUgoYUgoYUgoYUgoYUgoYUgoYU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" alt="plot of chunk unnamed-chunk-21"/> </p>

<p>And we find a peak at the 3 Hz harmonics, as expected!</p>

<p>There are several R libraries (surprise!) that produce this type of frequency plots. Here&#39;s one eg (the results are not exactly the same, which might be the consequence of slightly different algorithms&hellip;):</p>

<pre><code class="r">library(GeneCycle)
</code></pre>

<pre><code>Error: there is no package called &#39;GeneCycle&#39;
</code></pre>

<pre><code class="r">
f.data &lt;- GeneCycle::periodogram(trajectory)
</code></pre>

<pre><code>Error: there is no package called &#39;GeneCycle&#39;
</code></pre>

<pre><code class="r">harmonics &lt;- 1:(acq.freq/2)

plot(f.data$freq[harmonics]*length(trajectory), 
     f.data$spec[harmonics]/sum(f.data$spec), 
     xlab=&quot;Harmonics (Hz)&quot;, ylab=&quot;Amplitute Density&quot;, type=&quot;h&quot;)
</code></pre>

<pre><code>Error: object &#39;f.data&#39; not found
</code></pre>

<p>Check also <code>stats::spectrum()</code> and <code>TSA::periodogram()</code>.</p>

<p>If there is a trend in the time series, it should be detrended.</p>

<p>Eg:</p>

<pre><code class="r">trajectory1 &lt;- trajectory + 25*ts # let&#39;s create a linear trend 
plot(trajectory1, type=&quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-23"/> </p>

<pre><code class="r">
f.data &lt;- GeneCycle::periodogram(trajectory1)
</code></pre>

<pre><code>Error: there is no package called &#39;GeneCycle&#39;
</code></pre>

<pre><code class="r">harmonics &lt;- 1:20
plot(f.data$freq[harmonics]*length(trajectory1), 
     f.data$spec[harmonics]/sum(f.data$spec), 
     xlab=&quot;Harmonics (Hz)&quot;, ylab=&quot;Amplitute Density&quot;, type=&quot;h&quot;)
</code></pre>

<pre><code>Error: object &#39;f.data&#39; not found
</code></pre>

<p>The trended time-series didn&#39;t capture the signal.</p>

<p>Let&#39;s detrended it know, ie, find the linear trend and work with the residuals:</p>

<pre><code class="r">trend &lt;- lm(trajectory1 ~ts)
detrended.trajectory &lt;- trend$residuals
plot(detrended.trajectory, type=&quot;l&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-24"/> </p>

<pre><code class="r">
f.data &lt;- GeneCycle::periodogram(detrended.trajectory)
</code></pre>

<pre><code>Error: there is no package called &#39;GeneCycle&#39;
</code></pre>

<pre><code class="r">harmonics &lt;- 1:20
plot(f.data$freq[harmonics]*length(detrended.trajectory), 
     f.data$spec[harmonics]/sum(f.data$spec), 
     xlab=&quot;Harmonics (Hz)&quot;, ylab=&quot;Amplitute Density&quot;, type=&quot;h&quot;)
</code></pre>

<pre><code>Error: object &#39;f.data&#39; not found
</code></pre>

<p>Now the signal was caught!</p>

<p>Also, if we are trying to identify signals of \( n \times F \) Hz frequencies, the time series length should be divisible by \( F \), ie, we must do something like <code>detrended.trajectory[-(1:(length(detrended.trajectory) %% F))]</code>.</p>

<p>Let&#39;s try with a real dataset downloaded from <a href="http://www.quandl.com/BTS_MM-Bureau-of-Transportation-Statistics-Multimodal/RETAILGAS-Retail-Gasoline-Prices">Quandl</a> from retail prices of gasoline from 1995 until the present.</p>

<pre><code class="r">library(zoo) # use: index() converts Date to its index 
</code></pre>

<pre><code>Error: there is no package called &#39;zoo&#39;
</code></pre>

<pre><code class="r">
prices &lt;- read.csv(&quot;retailgas.csv&quot;)       # weekly prices (1 Hz = 1 Week)
prices &lt;- prices[order(nrow(prices):1),]  # revert data frame
plot(prices, type=&quot;l&quot;)

trend &lt;- lm(Price ~ index(Date), data = prices)
</code></pre>

<pre><code>Error: could not find function &quot;index&quot;
</code></pre>

<pre><code class="r">abline(trend, col=&quot;red&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABDgAAAFoCAMAAACFeLvtAAAAflBMVEX9/v0AAAAAADkAAGUAOTkAOWUAOY8AZrU5AAA5ADk5AGU5OWU5OY85ZrU5j7U5j9plAABlADllAGVlOQBlOY9ltf2POQCPOTmPOWWPZgCPtY+P29qP2/21ZgC1/rW1/v3ajzna24/a/rXa/v39tWX924/9/rX9/tr9/v3/AAAYfXOKAAAAKnRSTlP/////////////////////////////////////////////////////AP+MjuKjAAAACXBIWXMAAAsSAAALEgHS3X78AAAZtUlEQVR4nO3dC3ujOJqG4VH1bFVNb/UmXTNJ925XNtmNnbj+/x+cgDlI6IA+kIwQz33NlNM2COGgNyAE/O0CAEJ/27oCAPaH4AAgRnAAECM4AIgRHADECA4AYgQHADGCA4AYwQFAjOAAIEZwABAjOACIERwAxAgOAGIEBwAxggOAGMEBQIzgACBGcAAQIzgAiBEcAMQIDgBiBAcAMYIDgBjBAUCM4AAgRnAAECM4AIgRHADECA4AYgQHADGCA4AYwQFAjOAAIEZwABAjOACIERwAxAgOAGIEBwAxggOAGMEBQIzgACBGcAAQIzgAiBEcAMQIDgBiBAcAMYIDgBjBAUCM4AAgRnAAECM4AIgRHADECA4AYgQHADGCA4AYwQFAjOAAILYmOFSEnzETAShNxuCImObnivIBbIXgACBGcAAQIzgAiBEcAMQIDgBiBAcgNnc2sn6rg+P8tT2r+8uztOgWwYEdmh/HUL21wfH++NC+nj6/CotuERzYIXJjdXC8fX82XuOLbhEc2J8mNo6eHOxxAAscfZ9jdR/H2z19HDieg+cGZ1UAoaNnRovgACCWKji0ztHIC29bBAewR+xxABAjOAARZbwcVZrgOP9qn1QhOFCzws7HCsekra796gFg912Hhn0+luBAxcrKDanVY18TjOP4iAz2OHAU+w6MzvqLbRIcqrzdf/4/ggPYj4/YWJkcSfo4zl8dA0cJDlRtz7se3ottoleKsyrAIkX1jsrqoryzRK8UwQEsUlJuCLXx4MwI9jiAWygoPuKr4tvjuAZKioURHEBIGQcsC45UXDMJTrYQHMAy/p6CwnXpYIfE9WRL1CoRHMAyZexsyPX1dndyRK4UwQEIKOeP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" alt="plot of chunk unnamed-chunk-25"/> </p>

<pre><code class="r">detrended.trajectory &lt;- trend$residuals
plot(detrended.trajectory, type=&quot;l&quot;, main=&quot;detrended time series&quot;)
</code></pre>

<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAABDgAAAFoCAMAAACFeLvtAAAAh1BMVEX9/v0AAAAAADkAAGUAOWUAOY8AZo8AZrU5AAA5ADk5AGU5OY85ZrU5j485j9plAABlADllAGVlOQBlZjllZmVltbVltf2POQCPOTmPOWWPZgCPtY+P27WP29qP2/21ZgC1tWW1/rW1/v3ajzna/rXa/tra/v39tWX924/929r9/rX9/tr9/v1ld9gsAAAALXRSTlP//////////////////////////////////////////////////////////wCl7wv9AAAACXBIWXMAAAsSAAALEgHS3X78AAAdf0lEQVR4nO2diXbcOHZAB+44csYTqzuL1ZNk7IzVYykS///7UnuBwMPySIAkwHuPj8UFALHeAskq8k8DAICSP62dAQBoD8QBAGoQBwCoQRwAoAZxAIAaxAEAahAHAKhBHACgBnEAgBrEAQBqEAcAqEEcAKAGcQCAGsQBAGoQBwCoQRwAoAZxAIAaxAEAahAHAKhBHACgBnEAgBrEAQBqEAcAqEEcAKAGcQCAGsTRO2+PH39aq9+/qoKPthzivj3+8kOfA30c2DiIo3fGJvhuposjGRf2A+LomfcnY/7zNO6fjTkM++O6eXh/+vDv5sO3y7bDxl/+15jjpMANbm+5xD3OHl7MPz8dwj+fg1yDHnn9dE7onvTxSP9zmnFcw93CQMsgjo45jXVjDuP++2nhy1Ucp42XbddQD35wa8tYHFcOArgGPfL2KMX/+MejFe4WBpoGcXTM66fDiH0+jNLXT4eRephZ/DidbhyG88Nx52XbYfXL8HIK5Qa/bTkld4x7Fsdxj/n69vjh2z3l4ZLkME764XyNw0oSafQA4uiYl/Ow/fjzMkc4nJ6cxXFYGG7bTqvnUG7w25ZTcndxPJz+HiPeUx4uM46DQ8ZJD9Ys5cO3axhoG8TRMbniOIxjvTg+/vTEcbp+YayNgjiuYdasF5gP4uiY8bnHibs4bttu4vCDh05V7uLwzzwOoaykr+IYh+P+TPMgjo5xr3aeFx7Ow/m27SYOP7h9cfQU4cEVxz3l4TLhuF8xvYQ4f4/juukWBpoGcfTMceD/6+lM4/tldB/G7cd/nMVx3XYThxD8vmU4x/3DFcct6CWEuUnplOBNHHYOOFNpH8QBAGoQBwCo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" alt="plot of chunk unnamed-chunk-25"/> </p>

<pre><code class="r">
f.data &lt;- GeneCycle::periodogram(detrended.trajectory)
</code></pre>

<pre><code>Error: there is no package called &#39;GeneCycle&#39;
</code></pre>

<pre><code class="r">harmonics &lt;- 1:20 
plot(f.data$freq[harmonics]*length(detrended.trajectory), 
     f.data$spec[harmonics]/sum(f.data$spec), 
     xlab=&quot;Harmonics (Hz)&quot;, ylab=&quot;Amplitute Density&quot;, type=&quot;h&quot;)
</code></pre>

<pre><code>Error: object &#39;f.data&#39; not found
</code></pre>

<p>And we are able to see that the stronger signals are the 1Hz, 2Hz and 3Hz which makes some sense. The wages have a monthly or two-week cycle that reflects on the first harmonics (1 Hz here corresponds to 1 week cycle, 2 Hz means every 2 weeks, etc.).</p>

</body>

</html>

